plugin:
  name: custom-data-type-iucn
  version: 1.0
  url: https://github.com/programmfabrik/easydb-custom-data-type-iucn
  displayname:
    en-US: "Custom Data Type: IUCN"
    de-DE: "Custom Data Type: IUCN"
  info:
    de-DE: IUCN
    en-US: IUCN
  server:
    api-version:
      require: 1
  webfrontend:
    url: custom-data-type-iucn.js
    css: custom-data-type-iucn.css
    logo: image/logo.png
    l10n: l10n/

python-2:
  # endpoint: <ez5 url>/api/v1/plugin/extension/custom-data-type-iucn/proxy_api_v4
  file: src/server/main-easydb5.py

extensions:

  # endpoint: <fylr url>/api/v1/plugin/extension/custom-data-type-iucn/proxy_api_v4
  proxy_api_v4:
    exec:
      service: "python3"
      commands:
        - prog: "python3"
          stdin:
            type: "body"
          stdout:
            type: "body"
          args:
            - type: "value"
              value: "%_exec.pluginDir%/src/server/main-fylr.py"
            - type: "value"
              value: "%info.json%"

custom_types:
  iucn:
    update:
      script: build/scripts/iucn-update.js
      timeout: 10000
      batch_size: 100
      interval_base_config: update_interval_iucn.days
    mapping:
      idTaxon:
        type: text_oneline
      scientificName:
        type: text
      mainCommonName:
        type: text

base_config:
  - name: update_interval_iucn
    group: update_custom_data_type
    parameters:
      days:
        type: int
        min: 0
        default: 1
        position: 0
  - name: iucn_api_settings
    group: iucn
    parameters:
      api_url:
        type: text
        default: "https://api.iucnredlist.org/api/v4"
        position: 0
      api_token:
        type: text
        position: 1
  - name: iucn_easydb_settings
    group: iucn
    require_system_right: system.root
    parameters:
      easydb_login:
        type: text
        position: 0
      easydb_password:
        type: text
        position: 1
  - name: iucn_settings
    group: iucn
    parameters:
      tag_red:
        type: int
        position: 0
        plugin_type: "iucn_tag"
      iucn_fields:
        type: table
        position: 1
        fields:
          - name: iucn_field_name
            type: text
            position: 0
            plugin_type: "iucn_field_name"

